---
title: "vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(VarDecomp)
```

<!-- WARNING - This vignette is generated by {fusen} from dev/VarDecomp_package.Rmd: do not edit by hand -->

# brms_model: function for running brms models

```{r examples-brms_model, warning = FALSE, message = FALSE}

md = dplyr::starwars

# Centering variables
md = md %>% 
  dplyr::select(mass, sex, height, species) %>% 
  dplyr::mutate(mass = log(mass),
         sex = dplyr::recode(sex, "male" = 1, 
                      "female" = -1, 
                      "hermaphroditic" = 0,
                      "none" = as.numeric(NA)))
  
  
mod = brms_model(Chainset= 2, 
           Response = "mass", 
           FixedEffect = c("sex","height"), 
           RandomEffect = "species", 
           RandomSlope = "height",
           Family = "gaussian", 
           Data = md, 
           Seed = 0405)

print(mod)

plot(mod)

```

________


# var_decomp = function for variance decomposition

```{r examples-var_decomp}

md = dplyr::starwars

# Centering variables
md = md %>% 
  dplyr::select(mass, sex, species) %>% 
  dplyr::mutate(mass = log(mass),
         sex = dplyr::recode(sex, "male" = 1, 
                      "female" = -1, 
                      "hermaphroditic" = 0,
                      "none" = as.numeric(NA)))
  
  
mod = brms_model(Chainset= 2,
                 Response = "mass", 
                 FixedEffect = "sex", 
                 RandomEffect = "species",
                 Family = "gaussian", 
                 Data = md)

var_decomp(mod)
```

________


# compare_slopes: function for comparing slope values of different models

```{r examples-compare_slopes}

md = dplyr::starwars

# Centering variables
md = md %>% 
  dplyr::select(mass, sex, height, species) %>% 
  dplyr::mutate(mass = log(mass),
         sex = dplyr::recode(sex, "male" = 1, 
                      "female" = -1, 
                      "hermaphroditic" = 0,
                      "none" = as.numeric(NA)))
  
  
mod1 = brms_model(Chainset= 2,
                   Response = "mass", 
                   FixedEffect = "sex", 
                   Family = "gaussian", 
                   Data = md)

mod2 = brms_model(Chainset= 2,
                   Response = "mass", 
                   FixedEffect = "sex",
                   RandomEffect = "species",
                   RandomSlope = "sex",
                   Family = "gaussian", 
                   Data = md)

compare_slopes(mod1, mod2, Slope = "sex")
```

________


# model_fit = function for performing model fit checks

```{r examples-model_fit}
md = dplyr::starwars

# Centering variables
md = md %>% 
  dplyr::select(mass, sex, height, species) %>% 
  dplyr::mutate(mass = log(mass),
         sex = dplyr::recode(sex, "male" = 1, 
                      "female" = -1, 
                      "hermaphroditic" = 0,
                      "none" = as.numeric(NA)))


# Without random effects

mod = brms_model(Chainset= 2,
                 Response = "mass", 
                 FixedEffect = c("sex","height"), 
                 Family = "gaussian", 
                 Data = md,
                 PriorSamples = TRUE)

model_fit(mod, Group = "sex", Prior = TRUE)
```

